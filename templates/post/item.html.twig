{% set isFile = post.files|length > 0 %}
{% set icon   = isFile ? 'bi bi-file-earmark' : 'bi bi-chat-left-text' %}
{% set card   = isFile ? 'border-primary'     : 'border-success'      %}

<article class="card {{ card }} shadow-sm"
         id="post-{{ post.id }}"
         data-post-id="{{ post.id }}">
  <div class="card-body">

    <p class="mb-1 fw-semibold">
    <i class="{{ icon }} me-1"></i>
        {% if isFile %}
            Partage de fichier : 
            {% if post.files|length > 0 %}
            {% set file = post.files|first %}
            <a href="{{ path('post_download_file', { filename: file.filePath }) }}"
            class="btn btn-sm btn-outline-primary"
            download>
            <i class="bi bi-download"></i>&nbsp;
            {{ file.filePath|split('/')|last }}
            </a>
        {% endif %}
      {% else %}
        Message :
        <span class="text-success">
          {{ post.message|u.truncate(80, '…') }}
        </span>
      {% endif %}
    </p>

    

    <small class="text-muted">
      {{ post.userId.name }} {{ post.userId.surname }}
      – {{ post.date|date('d/m/Y H:i') }}
    </small>

    {% if is_granted('ROLE_TEACHER') %}
      <div class="btn-group btn-group-sm float-end">
        <a class="btn btn-outline-secondary"
           href="{{ path('app_post_edit', { id: post.id }) }}">
          Modifier
        </a>
        {% include 'post/_delete_form.html.twig' with { post: post } only %}
      </div>
    {% endif %}
  </div>
</article>
