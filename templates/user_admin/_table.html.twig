<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="h5 mb-0">Liste des utilisateurs</h2>

  {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_TEACHER') %}
    <button
      class="btn btn-success btn-sm"
      type="button"
      data-url="{{ path('app_user_admin_new') }}"
      data-action="click->user-admin#openEditModal">
      + Nouvel utilisateur
    </button>
  {% endif %}
</div>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Email</th>
      <th>Roles</th>
      <th>Pr√©nom</th>
      <th>Nom</th>
      {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_TEACHER') %}
        <th>Actions</th>
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for user in users %}
      <tr>
        <td>{{ user.email }}</td>
        <td>{{ user.roles|join(', ') }}</td>
        <td>{{ user.name }}</td>
        <td>{{ user.surname }}</td>

        {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_TEACHER') %}
          <td>
            {# Voir pour Teacher et Admin #}
            <a href="{{ path('app_user_admin_show', { id: user.id }) }}"
               class="btn btn-sm btn-info"
               data-action="user-admin#openEditModal">
              Voir
            </a>

            {# Modifier et Supprimer uniquement pour Admin #}
            {% if is_granted('ROLE_ADMIN') %}
              <a href="{{ path('app_user_admin_edit', { id: user.id }) }}"
                 class="btn btn-sm btn-primary"
                 data-action="user-admin#openEditModal">
                Modifier
              </a>

              <form method="post"
                    action="{{ path('app_user_admin_delete', { id: user.id }) }}"
                    data-action="user-admin#askDelete"
                    class="d-inline">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ user.id) }}">
                <button class="btn btn-sm btn-danger" type="submit">
                  Supprimer
                </button>
              </form>
            {% endif %}
          </td>
        {% endif %}
      </tr>
    {% else %}
      <tr>
        <td colspan="5" class="text-center text-muted">Aucun utilisateur</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
