{% extends 'base.html.twig' %}

{% block title %}Administration des utilisateurs{% endblock %}

{% block body %}
<div class="container my-5" data-controller="user-admin">
  <h1 class="mb-4">Gestion des utilisateurs</h1>

  <a href="{{ path('app_user_admin_new') }}" 
     class="btn btn-success mb-3"
     data-action="user-admin#openEditModal">
    + Nouvel utilisateur
  </a>

  <div id="user-table-container">
    {{ include('user_admin/_table.html.twig', { users: users }) }}
  </div>
</div>

{# Modal Bootstrap pour créer / éditer / voir un user #}
<div class="modal fade" id="modalUserAdmin" tabindex="-1" aria-labelledby="modalUserAdminLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content" data-user-admin-target="modalContent">
      <!-- Le contenu AJAX (formulaires) sera injecté ici -->
    </div>
  </div>
</div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script type="module">
    import { Application } from 'https://cdn.jsdelivr.net/npm/@hotwired/stimulus@3.2.2/dist/stimulus.js';
    import UserAdminController from '/assets/controllers/user_admin_controller.js';

    const application = Application.start();
    application.register('user-admin', UserAdminController);
  </script>
{% endblock %}
